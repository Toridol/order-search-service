<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Поиск заказов</title>
    <link rel="stylesheet" href="static/inter.css">
</head>
<body>
  <h1>Поиск заказа по ID</h1>
  <div class="search-box">
    <input id="orderId" type="text" placeholder="Введите order_uid">
    <button onclick="findOrder()">Найти</button>
  </div>

  <div id="result"></div>

  <script>
    async function findOrder() {
      const id = document.getElementById('orderId').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '';

      if (!id) {
        alert('Введите ID заказа');
        return;
      }

      try {
        const response = await fetch(`http://localhost:8080/order?id=${id}`);
        if (!response.ok) {
          resultDiv.innerHTML = '<p style="color:red;">Заказ не найден</p>';
          return;
        }

        const order = await response.json();

        resultDiv.innerHTML = `
          <div class="order-card">
            
            <div class="section">
              <h2>Основная информация</h2>
              <div class="field">
                <span class="label">Order UID:</span>
                <span class="value">${order.order_uid}</span>
                </div>
              <div class="field">
                <span class="label">Track Number:</span>
                <span class="value">${order.track_number}</span>
                </div>
              <div class="field">
                <span class="label">Customer ID:</span>
                <span class="value">${order.customer_id}</span>
                </div>
              <div class="field">
                <span class="label">Date:</span>
                <span class="value">${new Date(order.date_created).toLocaleString('ru-RU')}</span>
                </div>
            </div>

            <div class="section">
              <h2>Товары</h2>
              ${order.items.map(item => `
                <div class="item-card">
                  <div>
                    <div class="label">${item.name}</div>
                    <div class="value">${item.brand}</div>
                  </div>

                  <div class="price-block">
                    <div class="value">${item.total_price} ${order.payment.currency}</div>
                    ${item.total_price !== item.price ? `<div class="old-price">${item.price} ${order.payment.currency}</div>` : ''}
                  </div>
                </div>
              `).join('')}
            </div>

            <div class="section">
              <h2>Доставка</h2>
              <div class="field">
                <span class="label">Имя:</span><span class="value">${order.delivery.name}</span>
                </div>
              <div class="field">
                <span class="label">Адрес:</span><span class="value">${order.delivery.address}, ${order.delivery.city}</span>
                </div>
              <div class="field">
                <span class="label">Телефон:</span>
                <span class="value">${order.delivery.phone}</span>
                </div>
              <div class="field">
                <span class="label">Email:</span>
                <span class="value">${order.delivery.email}</span>
                </div>
            </div>

            <div class="section">
              <h2>Оплата</h2>
              <div class="field">
                <span class="label">Стоимость доставки:</span>
                <span class="value">${order.payment.delivery_cost}</span>
                </div>
              <div class="field">
                <span class="label">Сумма к оплате:</span>
                <span class="value">${order.payment.amount}</span>
                </div>
              <div class="field">
                <span class="label">Банк:</span>
                <span class="value">${order.payment.bank}</span>
                </div>
              <div class="field">
                <span class="label">Валюта:</span>
                <span class="value">${order.payment.currency}</span>
                </div>
            </div>

          </div>
        `;
      } catch (err) {
        console.error(err);
        resultDiv.innerHTML = '<p style="color:red;">Ошибка при запросе</p>';
      }
    }
  </script>
</body>
</html>